

| **Credit** | **Profile**                                                   |
|-------------|---------------------------------------------------------------|
| **Hacksprob**  | https://www.linkedin.com/in/hacksprob    |


# SQLi Research Report

### Kushagra Varshney
**Cyber Security Intern, CyberSapiens**

## 1. Introduction to SQL

Structured Query Language (SQL) is a standardized programming language used for managing and manipulating relational databases. Originally developed in the early 1970s, SQL has become the standard language for database management systems. It allows users to create, modify, and query data in relational databases. SQL provides a wide range of functions, including data insertion, querying, updating, and deletion, as well as schema creation and modification.

SQL has been widely adopted for handling data in web applications, business intelligence, and other data-driven domains. It became a standard of the American National Standards Institute (ANSI) in 1986 and the International Organization for Standardization (ISO) in 1987.

Beyond basic `SELECT` queries, SQL provides powerful functions such as subqueries, joins, and transactions that allow complex data retrieval and manipulation. For example, a `JOIN` query might combine data from multiple tables like this:

```sql
SELECT orders.order_id, customers.customer_name  
FROM orders  
JOIN customers ON orders.customer_id = customers.customer_id;
```

This query retrieves all order IDs along with the names of customers who placed those orders. Complex SQL queries can range from nested subqueries to recursive queries, which are used in applications like hierarchical data retrieval.

## 2. Example of an SQL Query

An SQL query is a request made to a database to retrieve or manipulate data. Queries are used to extract specific information from a database, which can then be used for reports, analysis, or further processing. Below is an example of a basic SQL query that retrieves data from a 'users' table:

```sql
SELECT * FROM users WHERE user_id = 1;
```

This query retrieves all the information from the 'users' table where the `user_id` equals 1. Queries can range from simple `SELECT` statements to complex joins and subqueries that pull information from multiple tables.

## 3. Important SQL Commands

SQL commands can be divided into several categories such as Data Query Language (DQL), Data Manipulation Language (DML), Data Definition Language (DDL), and Data Control Language (DCL). Below are some of the most important SQL commands:

- **SELECT:** Retrieves data from one or more tables.
- **INSERT INTO:** Adds new rows to a table.
- **UPDATE:** Modifies existing data in a table.
- **DELETE:** Removes rows from a table.
- **CREATE TABLE:** Creates a new table in the database.
- **ALTER TABLE:** Modifies the structure of an existing table.
- **JOIN:** Combines rows from two or more tables based on a related column between them.
- **UNION:** Combines the result sets of two or more `SELECT` statements into a single result set.

## 4. SQL Injection (SQLi) Attack

SQL Injection (SQLi) is a code injection technique that exploits vulnerabilities in an application's software by manipulating the SQL queries executed by the backend database. Attackers can use SQL injection to access, modify, or delete unauthorized data, or even perform administrative operations on the database such as dropping tables or executing shell commands.

For example, consider a login form that processes user input using the following SQL query:

```sql
SELECT * FROM users WHERE username = 'user' AND password = 'pass';
```

An attacker might input something like `' OR '1'='1` into the username or password field, modifying the query to:

```sql
SELECT * FROM users WHERE username = '' OR '1'='1' AND password = '' OR '1'='1';
```

This would allow the attacker to bypass authentication and log in as any user. SQL injections come in various forms, but all involve inserting or "injecting" malicious SQL code into an application's database queries. Below are extended descriptions and examples of SQL Injection types:

### 1. Error-Based SQL Injection

This form of attack uses error messages returned by the database to gather information about its structure. Attackers can craft SQL statements that intentionally produce errors, revealing details about table and column names.

### 2. UNION-Based SQL Injection

In this type of attack, the `UNION` operator is used to append additional `SELECT` queries to an original query, enabling attackers to retrieve data from different tables in the same database. For example, if the query:

```sql
SELECT name, email FROM users WHERE id = 1;
```

is modified as:

```sql
SELECT name, email FROM users WHERE id = 1 UNION SELECT credit_card_number, NULL FROM credit_cards;
```

The attacker can obtain credit card numbers from the 'credit_cards' table while still showing the valid results from the 'users' table.

## 5. Types of SQL Injection

There are several types of SQL Injection attacks, each exploiting different vulnerabilities in database handling. Below are the major types:

### 5.1 Error-Based SQLi

Error-based SQL injection occurs when an attacker uses database error messages to gather information about the structure of the database. These errors can provide details about table names, column names, and data types.

### 5.2 Union-Based SQLi

Union-based SQLi allows attackers to retrieve data by appending a malicious SQL query using the `UNION` operator. This combines the results of the original query with another `SELECT` statement, potentially revealing sensitive data.

### 5.3 Blind SQLi

In Blind SQL Injection, the attacker sends payloads to the database and infers information based on the application's response. There are two types:

- **Boolean-Based Blind SQLi:** The attacker modifies the query to return true/false results, observing whether the page behaves differently.
- **Time-Based Blind SQLi:** The attacker forces the database to delay its response, allowing them to infer information based on the response time.

Several high-profile companies have fallen victim to SQL Injection attacks, with dire consequences:

1. **TalkTalk Breach (2015):** One of the UK's largest telecommunications companies, TalkTalk, was breached using SQL injection, leading to the exposure of over 150,000 customers' personal details, including credit card numbers. The attack cost the company over Â£60 million in fines and remediation.

2. **Heartland Payment Systems (2008):** One of the biggest data breaches in history, Heartland's SQL injection attack exposed millions of payment card details. Attackers used a SQL injection vulnerability in the company's website to install malware on its servers, leading to the theft of cardholder data.

## 6. Impact of SQL Injection

The impact of a successful SQL Injection attack can be severe, affecting the integrity, confidentiality, and availability of data. Some of the most critical consequences include:

- Unauthorized access to sensitive information such as usernames, passwords, and credit card details.
- Data theft and unauthorized modification of database records.
- Loss of data integrity, leading to corrupted data.
- System downtime, affecting service availability.
- Financial losses and damage to organizational reputation.

## 7. Mitigation Measures

To prevent SQL Injection attacks, it is essential to implement strong security practices, including:

- **Input validation and sanitization:** Ensure that all user inputs are properly validated and sanitized to prevent malicious characters.
- **Use of prepared statements:** Prepared statements with parameterized queries prevent SQLi by separating data from code.
- **Database privilege management:** Restrict database access rights and ensure least privilege is applied to reduce the impact of a compromise.
- **Regular security audits and penetration testing:** Regularly scan and test applications for SQL injection vulnerabilities.
- **Use of Web Application Firewalls (WAFs):** A WAF can help detect and block malicious SQL injection attempts.

## 8. Practical Implementation

In this section, we will demonstrate the practical steps taken to complete SQL injection exercises on the following platforms:

1. **TryHackMe:** SQL Injection Room.
2. **PortSwigger Web Security Academy SQL Injection Labs.**

## 9. References

- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
- [PortSwigger SQL Injection Cheat Sheet](https://portswigger.net/web-security/sql-injection)
- [TryHackMe SQL Injection Room](https://tryhackme.com/room/sqlinjectionlm)
- [Heartland Data Breach Details](https://www.computerworld.com/article/2525536/heartland-data-breach-what-went-wrong.html)
- [TalkTalk Breach (2015)](https://www.bbc.com/news/uk-34611857)

---
